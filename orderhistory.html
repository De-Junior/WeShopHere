<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Order History - WeShopOnline</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* Reset & Base */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
    }

    body {
      background: #f4f6f8;
      color: #1f2937;
      line-height: 1.5;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    button {
      font-family: inherit;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    button:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    /* Header */
    header {
      background: #1f2937;
      color: #fff;
      padding: 14px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo a {
      font-size: 28px;
      font-weight: 700;
      color: #38bdf8;
    }

    .header-actions {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .back-to-shop {
      color: #fff;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .back-to-shop:hover {
      text-decoration: underline;
    }

    /* Page Header */
    .page-header {
      max-width: 1200px;
      margin: 40px auto 30px;
      padding: 0 16px;
    }

    .page-title {
      font-size: 32px;
      font-weight: 800;
      color: #1f2937;
      margin-bottom: 8px;
    }

    .page-subtitle {
      font-size: 16px;
      color: #6b7280;
    }

    /* Order History Container */
    .order-history-container {
      max-width: 1200px;
      margin: 0 auto 60px;
      padding: 0 16px;
    }

    /* Filters Section */
    .filters-section {
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 30px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .filters-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .filters-title {
      font-size: 18px;
      font-weight: 700;
      color: #1f2937;
    }

    .clear-filters {
      background: #f1f5f9;
      border: 1px solid #d1d5db;
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      color: #1f2937;
    }

    .clear-filters:hover {
      background: #e2e8f0;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .filter-group {
      margin-bottom: 16px;
    }

    .filter-group label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #374151;
    }

    .filter-group select,
    .filter-group input {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 14px;
    }

    .filter-group select:focus,
    .filter-group input:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    /* Search Box */
    .search-box {
      position: relative;
      margin-bottom: 20px;
    }

    .search-box input {
      width: 100%;
      padding: 12px 16px 12px 44px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 14px;
    }

    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: #6b7280;
    }

    /* Statistics Cards */
    .stats-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      display: flex;
      align-items: center;
      gap: 16px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .stat-content {
      flex: 1;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 800;
      color: #1f2937;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 14px;
      color: #6b7280;
    }

    /* Orders List */
    .orders-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .no-orders {
      background: #fff;
      border-radius: 12px;
      padding: 60px 40px;
      text-align: center;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .no-orders-icon {
      font-size: 64px;
      color: #d1d5db;
      margin-bottom: 20px;
    }

    .no-orders-title {
      font-size: 24px;
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 12px;
    }

    .no-orders-text {
      font-size: 16px;
      color: #6b7280;
      margin-bottom: 30px;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    .shop-now-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 14px 32px;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .shop-now-btn:hover {
      background: #1d4ed8;
      transform: translateY(-2px);
    }

    /* Order Card */
    .order-card {
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .order-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      background: #f9fafb;
      border-bottom: 1px solid #e5e7eb;
    }

    .order-info {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .order-number {
      font-size: 16px;
      font-weight: 700;
      color: #1f2937;
    }

    .order-date {
      font-size: 14px;
      color: #6b7280;
    }

    .order-status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 600;
    }

    .status-confirmed {
      background: #dcfce7;
      color: #15803d;
    }

    .status-shipped {
      background: #dbeafe;
      color: #1d4ed8;
    }

    .status-delivered {
      background: #f0f9ff;
      color: #0369a1;
    }

    .status-cancelled {
      background: #fee2e2;
      color: #dc2626;
    }

    .status-processing {
      background: #fef3c7;
      color: #d97706;
    }

    .order-actions {
      display: flex;
      gap: 8px;
    }

    .action-btn {
      padding: 8px 16px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 600;
      color: #1f2937;
      background: #fff;
      transition: all 0.2s ease;
    }

    .action-btn:hover {
      background: #f1f5f9;
    }

    .action-btn.primary {
      background: #2563eb;
      color: white;
      border-color: #2563eb;
    }

    .action-btn.primary:hover {
      background: #1d4ed8;
    }

    .order-body {
      padding: 24px;
    }

    .order-items-preview {
      display: flex;
      gap: 16px;
      margin-bottom: 20px;
      overflow-x: auto;
      padding-bottom: 10px;
    }

    .order-item-preview {
      flex-shrink: 0;
      width: 80px;
      text-align: center;
    }

    .item-image {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      overflow: hidden;
      background: #f9fafb;
      margin-bottom: 8px;
    }

    .item-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .item-name {
      font-size: 12px;
      color: #1f2937;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .item-quantity {
      font-size: 11px;
      color: #6b7280;
    }

    .order-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      padding: 20px;
      background: #f9fafb;
      border-radius: 8px;
    }

    .summary-item {
      display: flex;
      flex-direction: column;
    }

    .summary-label {
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 4px;
    }

    .summary-value {
      font-size: 15px;
      font-weight: 600;
      color: #1f2937;
    }

    .summary-value.amount {
      color: #16a34a;
      font-weight: 700;
    }

    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 40px;
    }

    .page-btn {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      background: #fff;
      font-weight: 600;
      color: #1f2937;
      transition: all 0.2s ease;
    }

    .page-btn:hover {
      background: #f1f5f9;
    }

    .page-btn.active {
      background: #2563eb;
      color: white;
      border-color: #2563eb;
    }

    .page-btn.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Order Details Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 20px;
      overflow-y: auto;
    }

    .modal-overlay.active {
      display: flex !important;
    }

    .modal-content {
      background: white;
      border-radius: 16px;
      width: 100%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      animation: modalFadeIn 0.3s ease;
    }

    @keyframes modalFadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 24px;
      border-bottom: 1px solid #e5e7eb;
      position: sticky;
      top: 0;
      background: white;
      z-index: 10;
    }

    .modal-header h2 {
      font-size: 24px;
      font-weight: 700;
      color: #1f2937;
      margin: 0;
    }

    .close-modal {
      background: none;
      border: none;
      font-size: 32px;
      color: #6b7280;
      cursor: pointer;
      padding: 4px;
      border-radius: 4px;
      line-height: 1;
    }

    .close-modal:hover {
      background: #f3f4f6;
      color: #1f2937;
    }

    .modal-body {
      padding: 24px;
    }

    /* Order Details Sections */
    .order-details-section {
      margin-bottom: 32px;
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title i {
      font-size: 20px;
    }

    .details-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    @media (max-width: 768px) {
      .details-grid {
        grid-template-columns: 1fr;
      }
    }

    .detail-item {
      margin-bottom: 12px;
    }

    .detail-label {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 4px;
      font-weight: 500;
    }

    .detail-value {
      font-size: 15px;
      color: #1f2937;
      font-weight: 600;
    }

    .detail-value.amount {
      color: #16a34a;
      font-weight: 700;
    }

    /* Order Items in Modal */
    .order-items-list {
      margin: 20px 0;
    }

    .order-item-detail {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px;
      border-bottom: 1px solid #e5e7eb;
      background: #f9fafb;
      border-radius: 8px;
      margin-bottom: 12px;
    }

    .order-item-detail:last-child {
      border-bottom: none;
    }

    .item-image-large {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      overflow: hidden;
      background: #fff;
      flex-shrink: 0;
    }

    .item-image-large img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .item-details {
      flex: 1;
    }

    .item-name-large {
      font-size: 16px;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 4px;
    }

    .item-sku {
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 8px;
    }

    .item-meta {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .item-price {
      font-size: 16px;
      font-weight: 700;
      color: #16a34a;
    }

    .item-quantity-large {
      font-size: 14px;
      color: #6b7280;
    }

    /* Timeline in Modal */
    .timeline {
      position: relative;
      padding-left: 30px;
      margin-top: 20px;
    }

    .timeline:before {
      content: '';
      position: absolute;
      left: 11px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: #e5e7eb;
    }

    .timeline-step {
      position: relative;
      margin-bottom: 24px;
    }

    .timeline-step:last-child {
      margin-bottom: 0;
    }

    .timeline-step.completed:before {
      background: #10b981;
      border-color: #10b981;
    }

    .timeline-step.current:before {
      background: #2563eb;
      border-color: #2563eb;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); }
      100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }
    }

    .timeline-step:before {
      content: '';
      position: absolute;
      left: -26px;
      top: 4px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #e5e7eb;
      border: 2px solid #fff;
      z-index: 2;
    }

    .timeline-step.completed:after {
      content: '‚úì';
      position: absolute;
      left: -24px;
      top: 4px;
      color: #fff;
      font-size: 8px;
      font-weight: bold;
      z-index: 3;
    }

    .timeline-label {
      font-size: 14px;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 4px;
    }

    .timeline-date {
      font-size: 13px;
      color: #6b7280;
      margin-bottom: 4px;
    }

    .timeline-description {
      font-size: 13px;
      color: #4b5563;
    }

    /* Modal Actions */
    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      padding: 20px 24px;
      border-top: 1px solid #e5e7eb;
      background: #f9fafb;
      border-radius: 0 0 16px 16px;
    }

    .modal-btn {
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .modal-btn.primary {
      background: #2563eb;
      color: white;
    }

    .modal-btn.primary:hover {
      background: #1d4ed8;
    }

    .modal-btn.secondary {
      background: #f1f5f9;
      color: #1f2937;
      border: 1px solid #d1d5db;
    }

    .modal-btn.secondary:hover {
      background: #e2e8f0;
    }

    /* Loading State */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .order-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
      }

      .order-actions {
        width: 100%;
        justify-content: flex-start;
      }

      .modal-actions {
        flex-direction: column;
      }

      .modal-btn {
        width: 100%;
      }
    }
  </style>
</head>

<body>

<header>
  <div class="logo"><a href="index.html">WeShopOnline</a></div>
  <div class="header-actions">
    <a href="index.html" class="back-to-shop">
      üè™ Continue Shopping
    </a>
  </div>
</header>

<!-- Page Header -->
<div class="page-header">
  <h1 class="page-title">Order History</h1>
  <p class="page-subtitle">View and manage all your past orders in one place</p>
</div>

<div class="order-history-container">
  <!-- Filters Section -->
  <div class="filters-section">
    <div class="filters-header">
      <h3 class="filters-title">Filter Orders</h3>
      <button class="clear-filters" onclick="clearFilters()">Clear Filters</button>
    </div>
    
    <div class="filters-grid">
      <div class="filter-group">
        <label for="statusFilter">Order Status</label>
        <select id="statusFilter" onchange="filterOrders()">
          <option value="all">All Statuses</option>
          <option value="confirmed">Confirmed</option>
          <option value="processing">Processing</option>
          <option value="shipped">Shipped</option>
          <option value="delivered">Delivered</option>
          <option value="cancelled">Cancelled</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="timeFilter">Time Period</label>
        <select id="timeFilter" onchange="filterOrders()">
          <option value="all">All Time</option>
          <option value="last30">Last 30 Days</option>
          <option value="last90">Last 90 Days</option>
          <option value="lastYear">Last Year</option>
          <option value="2024">2024</option>
          <option value="2023">2023</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="sortBy">Sort By</label>
        <select id="sortBy" onchange="sortOrders()">
          <option value="newest">Newest First</option>
          <option value="oldest">Oldest First</option>
          <option value="totalHigh">Total: High to Low</option>
          <option value="totalLow">Total: Low to High</option>
        </select>
      </div>
    </div>
    
    <div class="search-box">
      <input type="text" id="searchOrders" placeholder="Search by order number, product name, or SKU..." oninput="searchOrders()">
      <span class="search-icon">üîç</span>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-cards">
    <div class="stat-card">
      <div class="stat-icon" style="background: #f0f9ff; color: #0369a1;">üì¶</div>
      <div class="stat-content">
        <div class="stat-value" id="totalOrders">0</div>
        <div class="stat-label">Total Orders</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon" style="background: #f0fdf4; color: #15803d;">üí∞</div>
      <div class="stat-content">
        <div class="stat-value" id="totalSpent">R0.00</div>
        <div class="stat-label">Total Spent</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon" style="background: #fef3c7; color: #d97706;">‚è≥</div>
      <div class="stat-content">
        <div class="stat-value" id="avgOrder">R0.00</div>
        <div class="stat-label">Average Order</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon" style="background: #fef2f2; color: #dc2626;">‚ùå</div>
      <div class="stat-content">
        <div class="stat-value" id="cancelledOrders">0</div>
        <div class="stat-label">Cancelled Orders</div>
      </div>
    </div>
  </div>

  <!-- Orders List -->
  <div class="orders-list" id="ordersList">
    <!-- Orders will be populated by JavaScript -->
  </div>

  <!-- Pagination -->
  <div class="pagination" id="pagination">
    <!-- Pagination will be populated by JavaScript -->
  </div>
</div>

<!-- Order Details Modal -->
<div class="modal-overlay" id="orderModal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Order Details</h2>
      <button class="close-modal" onclick="closeModal()">√ó</button>
    </div>
    <div class="modal-body" id="modalBody">
      <!-- Content will be populated by JavaScript -->
    </div>
    <div class="modal-actions">
      <button class="modal-btn secondary" onclick="closeModal()">Close</button>
      <button class="modal-btn primary" onclick="downloadInvoice()">Download Invoice</button>
      <button class="modal-btn secondary" onclick="trackOrder()">Track Order</button>
    </div>
  </div>
</div>

<script>
  // Sample order data (in a real app, this would come from an API)
  let orders = JSON.parse(localStorage.getItem('orderHistory')) || [
    {
      id: "ORD-123456",
      date: "2024-12-15T10:30:00Z",
      items: [
        { name: "Power Bank 20000mAh", price: 699, quantity: 1, image: "https://www.geewiz.co.za/247298-large_default/philips-2-port-20000mah-power-bank.jpg", sku: "PWR-20000-001" },
        { name: "Gaming Mouse", price: 499, quantity: 2, image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSX3YvNGeMRX9_7-ohSXJP_NvsHffPhRocMOg&s", sku: "GM-001-RGB" }
      ],
      customer: {
        firstName: "John",
        lastName: "Doe",
        address: "123 Main Street, Cape Town",
        city: "Cape Town",
        province: "WC",
        postalCode: "8001",
        phone: "+27 12 345 6789",
        email: "customer@example.com"
      },
      summary: {
        subtotal: 1697,
        shipping: 99,
        discount: 169.7,
        total: 1626.3
      },
      status: "delivered",
      paymentMethod: "card",
      trackingNumber: "TRK-7890123456",
      deliveryMethod: "standard",
      estimatedDelivery: "2024-12-22",
      actualDelivery: "2024-12-21"
    },
    {
      id: "ORD-789012",
      date: "2024-12-10T14:20:00Z",
      items: [
        { name: "Wireless Headphones", price: 899, quantity: 1, image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR9cYWSaBNIhOPF2gguIun1olGtIYrHAlOO7w&s", sku: "BUD-NC-TWS" },
        { name: "Laptop Backpack", price: 599, quantity: 1, image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSjbIUEScaDNkTsIes0bBoFHRiO1J_3SAyP-A&s", sku: "BAG-LT-015" }
      ],
      customer: {
        firstName: "John",
        lastName: "Doe",
        address: "123 Main Street, Cape Town",
        city: "Cape Town",
        province: "WC",
        postalCode: "8001",
        phone: "+27 12 345 6789",
        email: "customer@example.com"
      },
      summary: {
        subtotal: 1498,
        shipping: 99,
        discount: 149.8,
        total: 1447.2
      },
      status: "shipped",
      paymentMethod: "payfast",
      trackingNumber: "TRK-3456789012",
      deliveryMethod: "express",
      estimatedDelivery: "2024-12-13",
      actualDelivery: null
    },
    {
      id: "ORD-345678",
      date: "2024-11-28T09:15:00Z",
      items: [
        { name: "Mechanical Keyboard", price: 1199, quantity: 1, image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRyAi_LG8QC_eds60Y_C0c9oqc42Jhgef15qQ&s", sku: "KB-MECH-001" },
        { name: "Webcam Full HD", price: 699, quantity: 1, image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQjwGvClpbTLVQm4I-S-YkvcQHyU3wZENDV7Q&s", sku: "CAM-WEB-1080" }
      ],
      customer: {
        firstName: "John",
        lastName: "Doe",
        address: "123 Main Street, Cape Town",
        city: "Cape Town",
        province: "WC",
        postalCode: "8001",
        phone: "+27 12 345 6789",
        email: "customer@example.com"
      },
      summary: {
        subtotal: 1898,
        shipping: 0,
        discount: 189.8,
        total: 1708.2
      },
      status: "confirmed",
      paymentMethod: "eft",
      trackingNumber: null,
      deliveryMethod: "pickup",
      estimatedDelivery: "2024-11-29",
      actualDelivery: null
    },
    {
      id: "ORD-901234",
      date: "2024-11-15T16:45:00Z",
      items: [
        { name: "Smart Watch", price: 2499, quantity: 1, image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTk2l3m4n5o6p7q8r9s0t1u2v3w4x5y6z7a8b&s", sku: "WATCH-SMART-001" }
      ],
      customer: {
        firstName: "John",
        lastName: "Doe",
        address: "123 Main Street, Cape Town",
        city: "Cape Town",
        province: "WC",
        postalCode: "8001",
        phone: "+27 12 345 6789",
        email: "customer@example.com"
      },
      summary: {
        subtotal: 2499,
        shipping: 199,
        discount: 249.9,
        total: 2448.1
      },
      status: "cancelled",
      paymentMethod: "card",
      trackingNumber: null,
      deliveryMethod: "express",
      estimatedDelivery: "2024-11-18",
      actualDelivery: null
    },
    {
      id: "ORD-567890",
      date: "2024-10-05T11:20:00Z",
      items: [
        { name: "27-inch Monitor", price: 3499, quantity: 1, image: "https://www.dellonline.co.za/cdn/shop/files/C7FE19E8-896B-4063-924C-247DE7E9FF80_169200_800x.jpg?v=1708345394", sku: "MON-27-4K" },
        { name: "HDMI Cable", price: 129, quantity: 2, image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRqkmirhmblq7v0kyRW877Xqo7gud9TrgnLMQ&s", sku: "CBL-HDMI-20" }
      ],
      customer: {
        firstName: "John",
        lastName: "Doe",
        address: "123 Main Street, Cape Town",
        city: "Cape Town",
        province: "WC",
        postalCode: "8001",
        phone: "+27 12 345 6789",
        email: "customer@example.com"
      },
      summary: {
        subtotal: 3757,
        shipping: 99,
        discount: 375.7,
        total: 3480.3
      },
      status: "processing",
      paymentMethod: "cash",
      trackingNumber: null,
      deliveryMethod: "standard",
      estimatedDelivery: "2024-10-12",
      actualDelivery: null
    }
  ];

  // Pagination settings
  let currentPage = 1;
  const itemsPerPage = 5;
  let filteredOrders = [...orders];
  let currentSort = 'newest';

  // Initialize page
  document.addEventListener('DOMContentLoaded', () => {
    updateStatistics();
    renderOrders();
    setupPagination();
    setupEventListeners();
  });

  // Update statistics
  function updateStatistics() {
    const totalOrders = orders.length;
    const totalSpent = orders.reduce((sum, order) => sum + order.summary.total, 0);
    const avgOrder = totalOrders > 0 ? totalSpent / totalOrders : 0;
    const cancelledOrders = orders.filter(order => order.status === 'cancelled').length;
    
    document.getElementById('totalOrders').textContent = totalOrders;
    document.getElementById('totalSpent').textContent = `R${totalSpent.toFixed(2)}`;
    document.getElementById('avgOrder').textContent = `R${avgOrder.toFixed(2)}`;
    document.getElementById('cancelledOrders').textContent = cancelledOrders;
  }

  // Format date
  function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString('en-ZA', {
      year: 'numeric',
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  }

  // Format status
  function formatStatus(status) {
    const statusMap = {
      'confirmed': { label: 'Confirmed', class: 'status-confirmed' },
      'processing': { label: 'Processing', class: 'status-processing' },
      'shipped': { label: 'Shipped', class: 'status-shipped' },
      'delivered': { label: 'Delivered', class: 'status-delivered' },
      'cancelled': { label: 'Cancelled', class: 'status-cancelled' }
    };
    return statusMap[status] || { label: 'Unknown', class: 'status-processing' };
  }

  // Format payment method
  function formatPaymentMethod(method) {
    const methods = {
      'card': 'Credit Card',
      'payfast': 'PayFast',
      'eft': 'Bank Transfer',
      'cash': 'Cash on Delivery'
    };
    return methods[method] || method;
  }

  // Filter orders
  function filterOrders() {
    const statusFilter = document.getElementById('statusFilter').value;
    const timeFilter = document.getElementById('timeFilter').value;
    const searchTerm = document.getElementById('searchOrders').value.toLowerCase();
    
    filteredOrders = orders.filter(order => {
      // Status filter
      if (statusFilter !== 'all' && order.status !== statusFilter) {
        return false;
      }
      
      // Time filter
      if (timeFilter !== 'all') {
        const orderDate = new Date(order.date);
        const now = new Date();
        let cutoffDate = new Date();
        
        switch (timeFilter) {
          case 'last30':
            cutoffDate.setDate(now.getDate() - 30);
            break;
          case 'last90':
            cutoffDate.setDate(now.getDate() - 90);
            break;
          case 'lastYear':
            cutoffDate.setFullYear(now.getFullYear() - 1);
            break;
          case '2024':
            cutoffDate = new Date('2024-01-01');
            const end2024 = new Date('2024-12-31');
            return orderDate >= cutoffDate && orderDate <= end2024;
          case '2023':
            cutoffDate = new Date('2023-01-01');
            const end2023 = new Date('2023-12-31');
            return orderDate >= cutoffDate && orderDate <= end2023;
        }
        
        if (timeFilter !== '2024' && timeFilter !== '2023' && orderDate < cutoffDate) {
          return false;
        }
      }
      
      // Search filter
      if (searchTerm) {
        const matchesOrderId = order.id.toLowerCase().includes(searchTerm);
        const matchesItems = order.items.some(item => 
          item.name.toLowerCase().includes(searchTerm) || 
          item.sku.toLowerCase().includes(searchTerm)
        );
        
        if (!matchesOrderId && !matchesItems) {
          return false;
        }
      }
      
      return true;
    });
    
    // Apply current sort
    sortOrders(true);
  }

  // Sort orders
  function sortOrders(keepCurrentPage = false) {
    const sortBy = document.getElementById('sortBy').value;
    currentSort = sortBy;
    
    filteredOrders.sort((a, b) => {
      switch (sortBy) {
        case 'newest':
          return new Date(b.date) - new Date(a.date);
        case 'oldest':
          return new Date(a.date) - new Date(b.date);
        case 'totalHigh':
          return b.summary.total - a.summary.total;
        case 'totalLow':
          return a.summary.total - b.summary.total;
        default:
          return new Date(b.date) - new Date(a.date);
      }
    });
    
    if (!keepCurrentPage) {
      currentPage = 1;
    }
    
    renderOrders();
    setupPagination();
  }

  // Search orders
  function searchOrders() {
    filterOrders();
    currentPage = 1;
    renderOrders();
    setupPagination();
  }

  // Clear filters
  function clearFilters() {
    document.getElementById('statusFilter').value = 'all';
    document.getElementById('timeFilter').value = 'all';
    document.getElementById('sortBy').value = 'newest';
    document.getElementById('searchOrders').value = '';
    
    filteredOrders = [...orders];
    currentPage = 1;
    renderOrders();
    setupPagination();
  }

  // Render orders
  function renderOrders() {
    const ordersList = document.getElementById('ordersList');
    
    if (filteredOrders.length === 0) {
      ordersList.innerHTML = `
        <div class="no-orders">
          <div class="no-orders-icon">üì¶</div>
          <h3 class="no-orders-title">No Orders Found</h3>
          <p class="no-orders-text">
            ${document.getElementById('searchOrders').value 
              ? 'No orders match your search criteria. Try adjusting your filters.' 
              : 'You haven\'t placed any orders yet. Start shopping to see your order history here!'}
          </p>
          <button class="shop-now-btn" onclick="window.location.href='index.html'">
            üõçÔ∏è Start Shopping
          </button>
        </div>
      `;
      return;
    }
    
    // Calculate pagination
    const startIndex = (currentPage - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;
    const currentOrders = filteredOrders.slice(startIndex, endIndex);
    
    ordersList.innerHTML = '';
    
    currentOrders.forEach(order => {
      const status = formatStatus(order.status);
      const formattedDate = formatDate(order.date);
      const totalItems = order.items.reduce((sum, item) => sum + item.quantity, 0);
      
      const orderElement = document.createElement('div');
      orderElement.className = 'order-card';
      orderElement.innerHTML = `
        <div class="order-header">
          <div class="order-info">
            <div class="order-number">${order.id}</div>
            <div class="order-date">${formattedDate}</div>
            <span class="order-status ${status.class}">${status.label}</span>
          </div>
          <div class="order-actions">
            <button class="action-btn" onclick="viewOrderDetails('${order.id}')">View Details</button>
            ${order.status === 'delivered' ? '<button class="action-btn primary" onclick="reorder(\'' + order.id + '\')">Reorder</button>' : ''}
            ${order.status === 'shipped' ? '<button class="action-btn primary" onclick="trackOrder(\'' + order.id + '\')">Track</button>' : ''}
          </div>
        </div>
        <div class="order-body">
          <div class="order-items-preview">
            ${order.items.slice(0, 5).map(item => `
              <div class="order-item-preview">
                <div class="item-image">
                  <img src="${item.image}" alt="${item.name}">
                </div>
                <div class="item-name">${item.name}</div>
                <div class="item-quantity">Qty: ${item.quantity}</div>
              </div>
            `).join('')}
            ${order.items.length > 5 ? `<div class="order-item-preview" style="align-items: center; justify-content: center; color: #6b7280; font-size: 14px; font-weight: 600;">
              +${order.items.length - 5} more
            </div>` : ''}
          </div>
          <div class="order-summary">
            <div class="summary-item">
              <div class="summary-label">Total Items</div>
              <div class="summary-value">${totalItems} item${totalItems > 1 ? 's' : ''}</div>
            </div>
            <div class="summary-item">
              <div class="summary-label">Payment Method</div>
              <div class="summary-value">${formatPaymentMethod(order.paymentMethod)}</div>
            </div>
            <div class="summary-item">
              <div class="summary-label">Delivery Method</div>
              <div class="summary-value">${order.deliveryMethod === 'express' ? 'Express' : order.deliveryMethod === 'pickup' ? 'Store Pickup' : 'Standard'}</div>
            </div>
            <div class="summary-item">
              <div class="summary-label">Order Total</div>
              <div class="summary-value amount">R${order.summary.total.toFixed(2)}</div>
            </div>
          </div>
        </div>
      `;
      
      ordersList.appendChild(orderElement);
    });
  }

  // Setup pagination
  function setupPagination() {
    const pagination = document.getElementById('pagination');
    const totalPages = Math.ceil(filteredOrders.length / itemsPerPage);
    
    if (totalPages <= 1) {
      pagination.innerHTML = '';
      return;
    }
    
    let paginationHTML = '';
    
    // Previous button
    paginationHTML += `
      <button class="page-btn ${currentPage === 1 ? 'disabled' : ''}" 
              ${currentPage === 1 ? 'disabled' : ''} 
              onclick="changePage(${currentPage - 1})">
        ‚Üê
      </button>
    `;
    
    // Page numbers
    const maxVisiblePages = 5;
    let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
    let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
    
    if (endPage - startPage + 1 < maxVisiblePages) {
      startPage = Math.max(1, endPage - maxVisiblePages + 1);
    }
    
    if (startPage > 1) {
      paginationHTML += `<button class="page-btn" onclick="changePage(1)">1</button>`;
      if (startPage > 2) paginationHTML += `<span style="padding: 0 8px;">...</span>`;
    }
    
    for (let i = startPage; i <= endPage; i++) {
      paginationHTML += `
        <button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">
          ${i}
        </button>
      `;
    }
    
    if (endPage < totalPages) {
      if (endPage < totalPages - 1) paginationHTML += `<span style="padding: 0 8px;">...</span>`;
      paginationHTML += `<button class="page-btn" onclick="changePage(${totalPages})">${totalPages}</button>`;
    }
    
    // Next button
    paginationHTML += `
      <button class="page-btn ${currentPage === totalPages ? 'disabled' : ''}" 
              ${currentPage === totalPages ? 'disabled' : ''} 
              onclick="changePage(${currentPage + 1})">
        ‚Üí
      </button>
    `;
    
    pagination.innerHTML = paginationHTML;
  }

  // Change page
  function changePage(page) {
    if (page < 1 || page > Math.ceil(filteredOrders.length / itemsPerPage)) return;
    
    currentPage = page;
    renderOrders();
    setupPagination();
    
    // Scroll to top of orders list
    document.querySelector('.orders-list').scrollIntoView({ behavior: 'smooth' });
  }

  // View order details
  function viewOrderDetails(orderId) {
    const order = orders.find(o => o.id === orderId);
    if (!order) return;
    
    const status = formatStatus(order.status);
    const formattedDate = formatDate(order.date);
    const deliveryMethod = order.deliveryMethod === 'express' ? 'Express Delivery' : 
                          order.deliveryMethod === 'pickup' ? 'Store Pickup' : 'Standard Delivery';
    
    // Calculate timeline steps
    const orderDate = new Date(order.date);
    const timelineSteps = [
      { 
        label: 'Order Confirmed', 
        date: formatDate(order.date),
        completed: true,
        current: false
      },
      { 
        label: 'Processing Order', 
        date: getNextDay(orderDate, 1),
        completed: ['processing', 'shipped', 'delivered'].includes(order.status),
        current: order.status === 'processing'
      },
      { 
        label: 'Shipped', 
        date: getNextDay(orderDate, 2),
        completed: ['shipped', 'delivered'].includes(order.status),
        current: order.status === 'shipped'
      },
      { 
        label: 'Out for Delivery', 
        date: getNextDay(orderDate, order.deliveryMethod === 'express' ? 3 : 5),
        completed: order.status === 'delivered',
        current: false
      },
      { 
        label: 'Delivered', 
        date: order.actualDelivery ? formatDate(order.actualDelivery) : getNextDay(orderDate, order.deliveryMethod === 'express' ? 4 : 7),
        completed: order.status === 'delivered',
        current: order.status === 'delivered'
      }
    ];
    
    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = `
      <!-- Order Summary -->
      <div class="order-details-section">
        <h3 class="section-title"><i>üì¶</i> Order Summary</h3>
        <div class="details-grid">
          <div class="detail-item">
            <div class="detail-label">Order Number</div>
            <div class="detail-value">${order.id}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Order Date</div>
            <div class="detail-value">${formattedDate}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Order Status</div>
            <div class="detail-value" style="color: ${status.class === 'status-confirmed' ? '#15803d' : 
                                                status.class === 'status-processing' ? '#d97706' :
                                                status.class === 'status-shipped' ? '#1d4ed8' :
                                                status.class === 'status-delivered' ? '#0369a1' : '#dc2626'};">
              ${status.label}
            </div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Payment Status</div>
            <div class="detail-value" style="color: #10b981;">Paid</div>
          </div>
        </div>
      </div>
      
      <!-- Order Items -->
      <div class="order-details-section">
        <h3 class="section-title"><i>üõí</i> Order Items (${order.items.reduce((sum, item) => sum + item.quantity, 0)} items)</h3>
        <div class="order-items-list">
          ${order.items.map(item => `
            <div class="order-item-detail">
              <div class="item-image-large">
                <img src="${item.image}" alt="${item.name}">
              </div>
              <div class="item-details">
                <div class="item-name-large">${item.name}</div>
                <div class="item-sku">SKU: ${item.sku}</div>
                <div class="item-meta">
                  <div class="item-price">R${item.price.toFixed(2)}</div>
                  <div class="item-quantity-large">Qty: ${item.quantity}</div>
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      </div>
      
      <!-- Price Breakdown -->
      <div class="order-details-section">
        <h3 class="section-title"><i>üí∞</i> Price Breakdown</h3>
        <div class="details-grid">
          <div class="detail-item">
            <div class="detail-label">Subtotal</div>
            <div class="detail-value">R${order.summary.subtotal.toFixed(2)}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Shipping</div>
            <div class="detail-value">R${order.summary.shipping.toFixed(2)}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Discount</div>
            <div class="detail-value" style="color: #10b981;">-R${order.summary.discount.toFixed(2)}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Total Paid</div>
            <div class="detail-value amount">R${order.summary.total.toFixed(2)}</div>
          </div>
        </div>
      </div>
      
      <!-- Shipping Information -->
      <div class="order-details-section">
        <h3 class="section-title"><i>üöö</i> Shipping Information</h3>
        <div class="details-grid">
          <div class="detail-item">
            <div class="detail-label">Delivery Method</div>
            <div class="detail-value">${deliveryMethod}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Estimated Delivery</div>
            <div class="detail-value">${order.estimatedDelivery ? formatDate(order.estimatedDelivery) : 'Calculating...'}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Tracking Number</div>
            <div class="detail-value">${order.trackingNumber || 'Not available yet'}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Shipping Address</div>
            <div class="detail-value">${order.customer.address}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Contact Person</div>
            <div class="detail-value">${order.customer.firstName} ${order.customer.lastName}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Contact Number</div>
            <div class="detail-value">${order.customer.phone}</div>
          </div>
        </div>
      </div>
      
      <!-- Payment Information -->
      <div class="order-details-section">
        <h3 class="section-title"><i>üí≥</i> Payment Information</h3>
        <div class="details-grid">
          <div class="detail-item">
            <div class="detail-label">Payment Method</div>
            <div class="detail-value">${formatPaymentMethod(order.paymentMethod)}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Transaction ID</div>
            <div class="detail-value">${order.trackingNumber || 'N/A'}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Billing Address</div>
            <div class="detail-value">Same as shipping address</div>
          </div>
        </div>
      </div>
      
      <!-- Delivery Timeline -->
      <div class="order-details-section">
        <h3 class="section-title"><i>üìÖ</i> Delivery Timeline</h3>
        <div class="timeline">
          ${timelineSteps.map(step => `
            <div class="timeline-step ${step.completed ? 'completed' : ''} ${step.current ? 'current' : ''}">
              <div class="timeline-label">${step.label}</div>
              <div class="timeline-date">${step.date}</div>
              ${step.description ? `<div class="timeline-description">${step.description}</div>` : ''}
            </div>
          `).join('')}
        </div>
      </div>
    `;
    
    // Open modal
    document.getElementById('orderModal').classList.add('active');
    document.body.classList.add('modal-open');
  }

  // Helper function to get next day
  function getNextDay(date, days) {
    const nextDate = new Date(date);
    nextDate.setDate(nextDate.getDate() + days);
    return formatDate(nextDate.toISOString());
  }

  // Close modal
  function closeModal() {
    document.getElementById('orderModal').classList.remove('active');
    document.body.classList.remove('modal-open');
  }

  // Setup event listeners
  function setupEventListeners() {
    // Close modal on ESC key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeModal();
      }
    });
    
    // Close modal when clicking outside
    document.getElementById('orderModal').addEventListener('click', (e) => {
      if (e.target === document.getElementById('orderModal')) {
        closeModal();
      }
    });
  }

  // Download invoice
  function downloadInvoice() {
    const orderNumber = document.querySelector('#modalBody .detail-item .detail-value').textContent;
    showNotification(`Downloading invoice for ${orderNumber}...`);
    // In a real app, this would trigger a download
  }

  // Track order
  function trackOrder(orderId = null) {
    if (orderId) {
      const order = orders.find(o => o.id === orderId);
      if (order && order.trackingNumber) {
        alert(`Tracking your order ${orderId}\nTracking Number: ${order.trackingNumber}`);
      } else {
        alert(`Order ${orderId} doesn't have a tracking number yet. Please check back later.`);
      }
    } else {
      // From modal
      const orderNumber = document.querySelector('#modalBody .detail-item .detail-value').textContent;
      const trackingElement = document.querySelector('#modalBody .detail-item:nth-child(3) .detail-value');
      const trackingNumber = trackingElement ? trackingElement.textContent : 'Not available';
      
      if (trackingNumber !== 'Not available yet') {
        alert(`Tracking your order ${orderNumber}\nTracking Number: ${trackingNumber}`);
      } else {
        alert(`Order ${orderNumber} doesn't have a tracking number yet. Please check back later.`);
      }
    }
  }

  // Reorder
  function reorder(orderId) {
    const order = orders.find(o => o.id === orderId);
    if (order) {
      // Add items to cart
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      order.items.forEach(item => {
        const existingItem = cart.find(cartItem => cartItem.name === item.name);
        if (existingItem) {
          existingItem.quantity += item.quantity;
        } else {
          cart.push({ ...item });
        }
      });
      
      localStorage.setItem('cart', JSON.stringify(cart));
      showNotification('Items added to cart! Redirecting to cart...');
      
      setTimeout(() => {
        window.location.href = 'cart.html';
      }, 1500);
    }
  }

  // Show notification
  function showNotification(message) {
    const notification = document.createElement('div');
    notification.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      background: #10b981;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
      animation: slideIn 0.3s ease;
    `;
    
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `;
    document.head.appendChild(style);
    
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOut 0.3s ease';
      setTimeout(() => notification.remove(), 300);
    }, 2000);
  }

  // Export orders to CSV
  function exportToCSV() {
    const headers = ['Order ID', 'Date', 'Status', 'Items', 'Total', 'Payment Method'];
    const csvData = filteredOrders.map(order => [
      order.id,
      formatDate(order.date),
      formatStatus(order.status).label,
      order.items.reduce((sum, item) => sum + item.quantity, 0),
      `R${order.summary.total.toFixed(2)}`,
      formatPaymentMethod(order.paymentMethod)
    ]);
    
    const csvContent = [headers, ...csvData]
      .map(row => row.map(cell => `"${cell}"`).join(','))
      .join('\n');
    
    const blob = new Blob([csvContent], { type: 'text/csv' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `orders-${new Date().toISOString().split('T')[0]}.csv`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
    
    showNotification('Orders exported to CSV successfully!');
  }
</script>

</body>
</html>